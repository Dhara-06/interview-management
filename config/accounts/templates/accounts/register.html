<h2>Register</h2>
{% if messages %}
    <ul class="messages">
        {% for message in messages %}
            <li class="{{ message.tags }}">{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}

<form id="register-form" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.non_field_errors }}

    <p>
        {{ form.username.label_tag }} {{ form.username }}
    </p>

    <p>
        {{ form.email.label_tag }} {{ form.email }}
    </p>

    <p>
        {{ form.password.label_tag }} {{ form.password }}
    </p>

    <p>
        {{ form.full_name.label_tag }} {{ form.full_name }}
    </p>

    <p>
        {{ form.contact_number.label_tag }} {{ form.contact_number }}
    </p>

    <p id="resume-field">
        {{ form.resume.label_tag }} {{ form.resume }}
    </p>

    <p>
        {{ form.role.label_tag }} {{ form.role }}
    </p>

    <button type="submit">Register</button>
</form>

<script>
// Toggle resume visibility/requirement depending on selected role
document.addEventListener('DOMContentLoaded', function(){
    const roleSelect = document.querySelector('#id_role');
    const resumeField = document.getElementById('resume-field');
    const resumeInput = document.querySelector('#id_resume');

    function updateResumeVisibility(){
        const val = roleSelect ? roleSelect.value : '';
        if(val === 'CANDIDATE'){
            resumeField.style.display = '';
            if(resumeInput) resumeInput.required = true;
        } else {
            resumeField.style.display = 'none';
            if(resumeInput) resumeInput.required = false;
        }
    }

    if(roleSelect){
        roleSelect.addEventListener('change', updateResumeVisibility);
        updateResumeVisibility();
    }
});
</script>

<p>Already have an account? <a href="{% url 'login' %}">Login</a></p>
